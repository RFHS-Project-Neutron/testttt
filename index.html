<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link id="favicon" rel="icon" type="image/png" href="https://example.com/200x200">
    <script src="/js/dynamic.js" defer></script>
    <script src="/pp.js"></script>
    <script src=/js/playtime.js></script>
    <style>
        /* General Styles */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1c1c1c;
            color: #f0f0f0;
            margin: 0;
            padding: 0;
        }

        header {
            background-color: #282828;
            padding: 15px;
            text-align: center;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.3);
        }

        header h1 {
            color: #ff6a3d;
            font-size: 2.5rem;
        }

        .container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }

        /* Welcome Area */
        .welcome {
            background: linear-gradient(135deg, #282828 30%, #333333 100%);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0px 8px 15px rgba(0, 0, 0, 0.4);
            margin-bottom: 30px;
            text-align: center;
            position: relative; /* Make room for buttons */
        }

        .welcome h2 {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #ff6a3d;
        }

        .welcome p {
            color: #c0c0c0;
            font-size: 1.2rem;
        }

        /* Edit Profile and Logout Buttons */
        .welcome-buttons {
            position: absolute;
            top: 10px;
            right: 10px;
        }

        .welcome-buttons button {
            background-color: #ff6a3d;
            border: none;
            padding: 10px 15px;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 10px;
            font-size: 0.9rem;
        }

        .welcome-buttons button:hover {
            background-color: #ff5733;
        }

        /* Search Bar */
        .search-bar {
            width: 100%;
            max-width: 600px;
            margin-bottom: 30px;
            display: flex;
            margin-left: 50%;
            justify-content: center;
            transform: translateX(-50%);
        }

        input[type="text"] {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            background-color: #333;
            color: #fff;
            outline: none;
            box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.5);
            transition: 0.3s ease;
        }

        input[type="text"]:focus {
            box-shadow: 0px 4px 12px rgba(255, 106, 61, 0.7);
        }

        /* Tab Navigation */
        .tab-container {
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
        }

        .tab {
            padding: 10px 20px;
            margin: 0 10px;
            background-color: #333;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .tab:hover, .tab.active {
            background-color: #ff6a3d;
            color: white;
        }

        /* Section Headers */
        .library-section {
            display: none;
        }

        .library-section.active {
            display: block;
        }

        .library-section h3 {
            font-size: 2rem;
            margin-bottom: 20px;
            text-align: center;
            color: #ff6a3d;
        }

        /* Grid Layout */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            grid-gap: 20px;
            width: 100%;
        }

        /* Grid Layout */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, 150px); /* Each item will be 150px wide */
            grid-gap: 20px; /* Space between items */
        }

        /* Movies/TV Shows Grid - Rectangular Posters */
        .movies-tv-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, 150px); /* Each item will be 150px wide */
            grid-gap: 20px; /* Space between items */
        }
        
        .item {
            padding: 10px;
            background-color: #333;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start; /* Align items to the top */
            align-items: center; /* Center align horizontally */
            text-align: center; /* Center text */
            transition: 0.3s ease;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.4);
        }

        .item img {
            max-width: 100%; /* Ensure image scales well */
            height: auto; /* Maintain aspect ratio */
            border-radius: 10px;
            margin-bottom: 10px; /* Space between image and text */
        }

        .item span {
            margin-top: 10px; /* Space between text and image */
            font-size: 1rem; /* Font size for text */
            line-height: 1.2; /* Line height for better readability */
            color: #c0c0c0; /* Text color */
        }

        .item:hover {
            background-color: #ff6a3d;
            color: white;
        }

        /* Internet Search Section */
        .internet-search {
            text-align: center;
        }

        .internet-search input[type="text"] {
            width: 100%;
            max-width: 600px;
            padding: 15px;
            border-radius: 50px;
            border: none;
            font-size: 1rem;
            background-color: #333;
            color: white;
            margin-bottom: 20px;
        }

        .internet-search button {
            padding: 10px 20px;
            background-color: #ff6a3d;
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            cursor: pointer;
        }

        /* Footer */
        footer {
            margin-top: 40px;
            padding: 20px;
            background-color: #282828;
            text-align: center;
            color: #c0c0c0;
            font-size: 0.9rem;
        }
        
        a {
            color: white;
            text-decoration: none;
        }

        .iframe-container {
            margin-top: 20px; /* Adds space between the search bar and iframe */
            display: flex;
            justify-content: center; /* Centers the iframe horizontally */
        }

        .iframe-container iframe {
            border-radius: 10px; /* Adds rounded corners to the iframe */
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.3); /* Adds a shadow for better visual separation */
        }

        /* Style for tabs */
        .tabs {
            overflow: hidden;
            background-color: #f1f1f1;
            border-radius: 10px;
        }

        .tablinks {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
            font-size: 17px;
        }

        .tablinks:hover {
            background-color: #ddd;
        }

        .tablinks.active {
            background-color: #ccc;
        }

        /* Hide all tab contents by default */
        .tabcontent {
            display: none;
            padding: 20px;
            border-top: none;
        }

        .tabcontent h2 {
            margin-bottom: 20px;
        }

        .tabcontent ol {
            padding-left: 20px;
        }
        
/* Leaderboard Tabs */
.leaderboard-tabs {
    display: flex;
    justify-content: center;
    margin-bottom: 20px;
}

.tab-button {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 10px 20px;
    margin: 0 5px;
    cursor: pointer;
    border-radius: 5px;
    font-size: 16px;
    font-weight: bold;
}

.tab-button:hover {
    background-color: #0056b3;
}

.tab-button:focus {
    outline: none;
}

/* Leaderboard Container */
.leaderboard-container {
    max-width: 600px;
    margin: 0 auto;
    background-color: #f4f4f4;
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    padding: 20px;
}

/* Leaderboard Header */
.leaderboard-header {
    text-align: center;
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 20px;
}

/* Individual Leaderboard Row */
.leaderboard-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #ffffff;
    padding: 10px 20px;
    margin: 10px 0;
    border-radius: 4px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

/* Left side (Place & Username) */
.leaderboard-info {
    display: flex;
    align-items: center;
    font-size: 18px;
    font-weight: 500;
}

/* Place number */
.leaderboard-place {
    font-size: 20px;
    font-weight: bold;
    margin-right: 15px;
}

/* Username */
.leaderboard-user {
    font-size: 18px;
}

/* Score on the right */
.leaderboard-score {
    font-size: 18px;
    font-weight: bold;
}

/* Hover effect for rows */
.leaderboard-row:hover {
    background-color: #f0f0f0;
}

    </style>
</head>
    <body>

    <header>
        <h1>Neutron Plus</h1>
    </header>

    <div class="container">
        <!-- Welcome area for members -->
        <div class="welcome">
            <h2 id="welcome"></h2>
            <p id="subscription-message"></p>

            <!-- Buttons for logout and profile editing -->
            <div class="welcome-buttons">
                <button id="logout">Logout</button>
            </div>
        </div>

        <!-- Search Bar -->
        <div class="search-bar">
            <input type="text" id="searchInput" placeholder="Search for a game, TV show, or movie...">
        </div>

        <!-- Tab Navigation -->
        <div class="tab-container">
            <div class="tab active" data-section="games-section">Games</div>
            <div class="tab" data-section="movies-section">Movies</div>
            <div class="tab" data-section="tv-section">TV Shows</div>
            <div class="tab" data-section="internet-search-section">Internet Search</div>
            <div class="tab" data-section="leaderboards">Leaderboards</div>
        </div>

        <!-- Game Section -->
        <div class="library-section active" id="games-section">
            <h3>Games Library</h3>
            <div class="games-grid"></div>
        </div>

        <!-- Movies Section -->
        <div class="library-section" id="movies-section">
            <h3>Movies Library</h3>
            <div class="movies-tv-grid"></div>
        </div>

        <!-- TV Shows Section -->
        <div class="library-section" id="tv-section">
            <h3>TV Shows Library</h3>
            <div class="movies-tv-grid"></div>
        </div>

        <!-- Internet Search Section -->
        <div class="library-section" id="internet-search-section">
            <h3>Search the Internet</h3>
            <div class="iframe-container">
                <iframe class="frame" src="/search" width="100%" height="600px" style="border: none;"></iframe>
            </div>
        </div>
        
        <div class="library-section" id="leaderboards">
            <div class="leaderboard-tabs">
                <button class="tab-button active" onclick="loadLeaderboard('game1', this)">Game 1</button>
                <button class="tab-button" onclick="loadLeaderboard('game2', this)">Game 2</button>
                <button class="tab-button" onclick="loadLeaderboard('game3', this)">Game 3</button>
            </div>

            <div class="container">
                <div class="leaderboard-header">Leaderboard</div>
                <!-- The leaderboard rows will be dynamically inserted here -->
                <div id="leaderboard"></div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <p>&copy; 2024 Project Neutron. All rights reserved.</p>
    </footer>

    <script>
               // Function to fetch users data from the JSON file
        async function fetchUsers() {
            try {
                const response = await fetch('/users.json'); // Update this with your actual JSON file path
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return await response.json();
            } catch (error) {
                console.error('Failed to fetch users:', error);
                return []; // Return an empty array on error
            }
        }

        // Function to get user's name based on username
        function getUserName(users, username) {
            const user = users.find(user => user.username === username);
            return user ? user.name : null;
        }

        // Main function to display welcome message
async function displayWelcomeMessage() {
    const users = await fetchUsers(); // Fetch users data

    setInterval(() => {
        const savedUsername = localStorage.getItem('username'); // Example: 'vulture'

        // Update welcome message
        const username = savedUsername ? savedUsername : 'Guest';
        const userName = getUserName(users, username);
        const welcomeMessage = userName ? `Welcome, ${userName}` : 'Welcome, Guest';

        document.getElementById('welcome').textContent = welcomeMessage;
    }, 500); // Check for username update every 0.5 seconds
}

// Call the function to display the welcome message
displayWelcomeMessage();
    </script>
    <script>
// Function to switch between sections
const tabs = document.querySelectorAll('.tab');
const sections = document.querySelectorAll('.library-section');
const searchInput = document.getElementById('searchInput'); // Search bar input element

tabs.forEach(tab => {
    tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');

        sections.forEach(section => section.classList.remove('active'));
        const activeSection = document.getElementById(tab.getAttribute('data-section'));
        activeSection.classList.add('active');

        // Change search bar placeholder based on active tab
        if (tab.getAttribute('data-section') === 'games-section') {
            searchInput.placeholder = "Search for a game...";
        } else if (tab.getAttribute('data-section') === 'movies-section') {
            searchInput.placeholder = "Search for a movie...";
        } else if (tab.getAttribute('data-section') === 'tv-section') {
            searchInput.placeholder = "Search for a TV show...";
        }

        // Fetch movies or TV shows when respective tab is clicked
        if (tab.getAttribute('data-section') === 'movies-section') {
            fetchMovies(moviePageSet);
        } else if (tab.getAttribute('data-section') === 'tv-section') {
            fetchTVShows(tvPageSet);
        }
    });
});

// Real-time search functionality using 'input' event and debounce
searchInput.addEventListener('input', debounce(handleSearch, 300)); // Debounce to limit excessive API calls

// Debounce function to delay the search execution
function debounce(func, delay) {
    let debounceTimer;
    return function () {
        const context = this;
        const args = arguments;
        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(() => func.apply(context, args), delay);
    };
}

// Handle search based on active tab
function handleSearch() {
    const query = searchInput.value.trim();
    const activeTab = document.querySelector('.tab.active').getAttribute('data-section');

    if (activeTab === 'games-section') {
        searchGames(query);
    } else if (activeTab === 'movies-section') {
        searchMovies(query);
    } else if (activeTab === 'tv-section') {
        searchTVShows(query);
    }
}

// Search games function (example function to filter games based on search)
function searchGames(query) {
    const gamesGrid = document.querySelector('.games-grid');
    gamesGrid.innerHTML = ''; // Clear previous results

    fetch('https://premium.ezmath.site/config/games.json')
        .then(response => response.json())
        .then(games => {
            const filteredGames = games.filter(game => game.title.toLowerCase().includes(query.toLowerCase()));
            displayGames(filteredGames);
        })
        .catch(error => console.error('Error searching games:', error));
}

// Search movies function (TMDB search endpoint)
async function searchMovies(query) {
    const response = await fetch(`${baseUrl}/search/movie?api_key=${apiKey}&language=en-US&query=${query}`);
    const data = await response.json();
    const movies = data.results;

    moviesGrid.innerHTML = ''; // Clear previous results
    displayMovies(movies);
}

// Search TV shows function (TMDB search endpoint)
async function searchTVShows(query) {
    const response = await fetch(`${baseUrl}/search/tv?api_key=${apiKey}&language=en-US&query=${query}`);
    const data = await response.json();
    const tvShows = data.results;

    tvGrid.innerHTML = ''; // Clear previous results
    displayTVShows(tvShows);
}

// TMDB API constants
const apiKey = '9b80b3bf5231a6f349ac797f1a6135e6';
const baseUrl = 'https://api.themoviedb.org/3';
const imageBaseUrl = 'https://image.tmdb.org/t/p/w500';

let moviePageSet = 1;  // Tracks the current set of movie pages being loaded (1-5, 6-10, etc.)
let tvPageSet = 1;     // Tracks the current set of TV show pages

const moviesGrid = document.querySelector('#movies-section .movies-tv-grid');
const tvGrid = document.querySelector('#tv-section .movies-tv-grid');

// Function to fetch multiple pages of movies (pages 1-5, 6-10, etc.)
async function fetchMovies(pageSet) {
    const promises = [];
    for (let page = (pageSet - 1) * 5 + 1; page <= pageSet * 5; page++) {
        promises.push(fetch(`${baseUrl}/movie/popular?api_key=${apiKey}&language=en-US&page=${page}&certification_country=US&certification.lte=PG`));
    }
    const responses = await Promise.all(promises);
    const movies = [];
    for (let response of responses) {
        const data = await response.json();
        movies.push(...data.results);
    }
    displayMovies(movies);
}

// Function to fetch multiple pages of TV shows (pages 1-5, 6-10, etc.)
async function fetchTVShows(pageSet) {
    const promises = [];
    for (let page = (pageSet - 1) * 5 + 1; page <= pageSet * 5; page++) {
        promises.push(fetch(`${baseUrl}/tv/popular?api_key=${apiKey}&language=en-US&page=${page}`));
    }
    const responses = await Promise.all(promises);
    const tvShows = [];
    for (let response of responses) {
        const data = await response.json();
        tvShows.push(...data.results);
    }
    displayTVShows(tvShows);
}

// Function to display movies
function displayMovies(movies) {
    movies.forEach(movie => {
        const movieItem = document.createElement('div');
        movieItem.classList.add('item');
        movieItem.innerHTML = `
            <img src="${imageBaseUrl}${movie.poster_path}" alt="${movie.title}">
            <span>${movie.title}</span>
        `;

        // Add click event to open new tab with movie details
        movieItem.addEventListener('click', () => {
            window.open(`/movie?id=${movie.id}`, '_blank');
        });

        moviesGrid.appendChild(movieItem);
    });
}

// Function to display TV shows
function displayTVShows(tvShows) {
    tvShows.forEach(show => {
        const tvItem = document.createElement('div');
        tvItem.classList.add('item');
        tvItem.innerHTML = `
            <img src="${imageBaseUrl}${show.poster_path}" alt="${show.name}">
            <span>${show.name}</span>
        `;

        // Add click event to open new tab with TV show details
        tvItem.addEventListener('click', () => {
            window.open(`/tv?id=${show.id}`, '_blank');
        });

        tvGrid.appendChild(tvItem);
    });
}

// Function to load more movies or TV shows (called on button click or scroll event)
function loadMoreMovies() {
    moviePageSet++;
    fetchMovies(moviePageSet);
}

function loadMoreTVShows() {
    tvPageSet++;
    fetchTVShows(tvPageSet);
}

// Call the first set of movies and TV shows
fetchMovies(moviePageSet);
fetchTVShows(tvPageSet);

// Add a "Load More" button for movies
const loadMoreMoviesButton = document.createElement('button');
loadMoreMoviesButton.innerText = 'Load More Movies';
loadMoreMoviesButton.style.margin = '20px auto';
loadMoreMoviesButton.style.display = 'block';
loadMoreMoviesButton.onclick = loadMoreMovies;
moviesGrid.parentElement.appendChild(loadMoreMoviesButton);

// Add a "Load More" button for TV shows
const loadMoreTVButton = document.createElement('button');
loadMoreTVButton.innerText = 'Load More TV Shows';
loadMoreTVButton.style.margin = '20px auto';
loadMoreTVButton.style.display = 'block';
loadMoreTVButton.onclick = loadMoreTVShows;
tvGrid.parentElement.appendChild(loadMoreTVButton);

// Infinite scroll logic (detects when the user scrolls to the bottom of the page)
window.addEventListener('scroll', () => {
    if (window.innerHeight + window.scrollY >= document.body.offsetHeight) {
        const activeTab = document.querySelector('.tab.active').getAttribute('data-section');
        if (activeTab === 'movies-section') {
            loadMoreMovies();
        } else if (activeTab === 'tv-section') {
            loadMoreTVShows();
        }
    }
});

// Fetch games from config/games.json and display them
async function fetchGames() {
    try {
        const response = await fetch('https://premium.ezmath.site/config/games.json'); // Fetch the JSON file
        const games = await response.json(); // Parse the JSON file

        // Call the function to display the games in the grid
        displayGames(games);
    } catch (error) {
        console.error("Error fetching games:", error);
    }
}

// Function to display the games in the grid
function displayGames(games) {
    const gamesGrid = document.querySelector('.games-grid');

    // Clear previous games (if any)
    gamesGrid.innerHTML = '';

    games.forEach(game => {
        const gameItem = document.createElement('div');
        gameItem.classList.add('item');

        gameItem.innerHTML = `
            <img src="${game.imgSrc}" alt="${game.title}">
            <span>${game.title}</span>
        `;

        // Add click event to open the game in a new tab
        gameItem.addEventListener('click', () => {
            window.open(game.link, '_blank'); // Open the game URL in a new tab
        });

        gamesGrid.appendChild(gameItem);
    });
}

// Fetch and display games on page load
fetchGames();

        // Add event listener to the logout button
        document.getElementById('logout').addEventListener('click', () => {
            // Remove the username from local storage
            localStorage.removeItem('username');

            // Optional: Show a message or redirect after logout
            alert('You have been logged out.');
            // window.location.href = '/login.html'; // Uncomment this line to redirect to login page
        });

// Function to calculate the remaining days of the subscription
function calculateDaysRemaining(expirationDate) {
    const now = new Date();
    const expiration = new Date(expirationDate);
    const timeDiff = expiration - now; // Difference in milliseconds

    // Calculate days remaining
    const daysRemaining = Math.ceil(timeDiff / (1000 * 60 * 60 * 24)); // Convert milliseconds to days

    return daysRemaining;
}

// Function to display subscription expiration message
async function displaySubscriptionDays() {
    const users = await fetchUsers(); // Fetch users data
    const savedUsername = localStorage.getItem('username'); // Get the logged-in username

    if (savedUsername) {
        const user = users.find(user => user.username === savedUsername); // Find the logged-in user

        if (user && user.expiration) {
            const daysRemaining = calculateDaysRemaining(user.expiration);

            // Create a message based on remaining days
            const subscriptionMessage = daysRemaining > 0 
                ? `You have ${daysRemaining} day${daysRemaining > 1 ? 's' : ''} remaining on your subscription.`
                : 'Your subscription has ended.';

            // Update the subscription message dynamically
            document.getElementById('subscription-message').textContent = subscriptionMessage;
        } else {
            document.getElementById('subscription-message').textContent = 'No subscription found.';
        }
    } else {
        document.getElementById('subscription-message').textContent = 'You are not logged in.';
    }
}

// Call the function to display subscription expiration days
displaySubscriptionDays();
    </script>
</body>
</html>
